(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3ab5dcbf"],{"4c0f":function(e,t,a){},"90fe":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[e._l(e.searchNum,(function(t){return a("div",{staticClass:"filter-container"},[a("i",{staticClass:"el-icon-remove-outline",attrs:{id:t},on:{click:function(a){return e.deleteSearchNum(t)}}}),e._v(" "),a("el-select",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{placeholder:"Type"},model:{value:e.searchType[t],callback:function(a){e.$set(e.searchType,t,a)},expression:"searchType[i]"}},e._l(e.searchTypes,(function(e){return a("el-option",{attrs:{label:e.name,value:e.value}})})),1),e._v(" "),a("el-select",{staticClass:"filter-item",staticStyle:{width:"140px"},model:{value:e.searchField[t],callback:function(a){e.$set(e.searchField,t,a)},expression:"searchField[i]"}},e._l(e.findFields,(function(e,t){return a("el-option",{attrs:{label:e.alias,value:t}})})),1),e._v(" "),"equals"!=e.searchType[t]&&"like"!=e.searchType[t]?a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"search",type:"number"},model:{value:e.queryText[t],callback:function(a){e.$set(e.queryText,t,a)},expression:"queryText[i]"}}):a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"search",type:"text"},model:{value:e.queryText[t],callback:function(a){e.$set(e.queryText,t,a)},expression:"queryText[i]"}})],1)})),e._v(" "),a("div",{staticClass:"filter-container"},[e.permission.indexOf("find")>-1?a("i",{staticClass:"el-icon-circle-plus-outline",on:{click:e.addSearchNum}}):e._e(),e._v(" "),e.permission.indexOf("find")>-1?a("el-select",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{placeholder:"Type"},model:{value:e.searchType[0],callback:function(t){e.$set(e.searchType,0,t)},expression:"searchType[0]"}},e._l(e.searchTypes,(function(e){return a("el-option",{attrs:{label:e.name,value:e.value}})})),1):e._e(),e._v(" "),e.permission.indexOf("find")>-1?a("el-select",{staticClass:"filter-item",staticStyle:{width:"140px"},model:{value:e.searchField[0],callback:function(t){e.$set(e.searchField,0,t)},expression:"searchField[0]"}},e._l(e.findFields,(function(e,t){return a("el-option",{attrs:{label:e.alias,value:t}})})),1):e._e(),e._v(" "),e.permission.indexOf("find")>-1&&"equals"!=e.searchType[0]&&"like"!=e.searchType[0]?a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"search",type:"number"},model:{value:e.queryText[0],callback:function(t){e.$set(e.queryText,0,t)},expression:"queryText[0]"}}):e._e(),e._v(" "),e.permission.indexOf("find")>-1&&("equals"==e.searchType[0]||"like"==e.searchType[0])?a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"search",type:"text"},model:{value:e.queryText[0],callback:function(t){e.$set(e.queryText,0,t)},expression:"queryText[0]"}}):e._e(),e._v(" "),e.permission.indexOf("find")>-1?a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("\n       Search\n     ")]):e._e(),e._v(" "),e.permission.indexOf("insert")>-1?a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleAdd}},[e._v("Add")]):e._e(),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{loading:e.downloadLoading,type:"primary",icon:"el-icon-download"},on:{click:e.handleDownload}},[e._v("Export")]),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-refresh-left"},on:{click:e.refreshData}},[e._v("refresh")]),e._v(" "),null!=e.readyCharts?a("el-dropdown",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},on:{command:e.selectChart}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-s-grid"}},[e._v("\n         查看视图\n       ")]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.readyCharts,(function(t,i){return a("el-dropdown-item",{attrs:{command:t}},[e._v(e._s(i))])})),1)],1):e._e(),e._v(" "),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-s-data"},on:{click:function(t){e.makeChartVisible=!0}}},[e._v("\n       制作视图\n     ")])],1),e._v(" "),a("el-checkbox-group",{model:{value:e.choiceFields,callback:function(t){e.choiceFields=t},expression:"choiceFields"}},[e._l(e.defultFields,(function(t,i){return a("el-checkbox",{attrs:{label:i,checked:""}},[e._v(e._s(t.alias))])})),e._v(" "),a("el-checkbox",{attrs:{label:"remoteSort"}},[e._v("远程排序")])],2),e._v(" "),a("br"),e._v(" "),a("el-pagination",{staticStyle:{overflow:"auto"},attrs:{"current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalNum},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""},on:{"sort-change":e.sortChange}},[e._l(e.fields,(function(t,i){return a("el-table-column",{attrs:{prop:i,label:t.alias,sortable:-1==e.choiceFields.indexOf("remoteSort")||e.sortFields.indexOf(i)>-1},scopedSlots:e._u([{key:"default",fn:function(l){return[("String"==t.webFieldType||"Number"==t.webFieldType)&&void 0!=l.row[i]&&l.row[i].toString().length>20?a("div",[a("el-tooltip",{attrs:{content:l.row[i],placement:"bottom",effect:"light"}},[a("span",[e._v(" "+e._s(l.row[i].slice(0,20)+"..."))])])],1):e._e(),e._v(" "),("String"==t.webFieldType||"Number"==t.webFieldType)&&void 0!=l.row[i]&&l.row[i].toString().length<=20?a("div",[e._v(e._s(l.row[i]))]):e._e(),e._v(" "),"ImageURL"==t.webFieldType?a("img",{attrs:{height:"50px;",src:l.row[i]},on:{click:function(t){return e.previewImage(l.row[i])}}}):e._e(),e._v(" "),"ImageBASE64"==t.webFieldType?a("img",{attrs:{height:"50px;",src:l.row[i]},on:{click:function(t){return e.previewImage(l.row[i])}}}):e._e(),e._v(" "),"Select"==t.webFieldType?a("div",[e._v(e._s(t.selectArr[l.row[i]]))]):e._e()]}}],null,!0)})})),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleLook(t.row)}}},[e._v("查看")]),e._v(" "),e.permission.indexOf("update")>-1?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v("编辑")]):e._e(),e._v(" "),e.permission.indexOf("delete")>-1?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")]):e._e()],1)]}}])})],2),e._v(" "),a("br"),e._v(" "),a("el-dialog",{attrs:{title:"Preview",visible:e.dialogPreviewVisible},on:{"update:visible":function(t){e.dialogPreviewVisible=t}}},[a("img",{staticStyle:{"margin-left":"1%"},attrs:{width:"98%;",src:e.previewImageUrl}})]),e._v(" "),a("el-dialog",{attrs:{title:"Look",visible:e.dialogLookVisible},on:{"update:visible":function(t){e.dialogLookVisible=t}}},[a("form",[a("el-form",{attrs:{"label-width":"80px"}},e._l(e.lookFields,(function(t,i){return a("el-form-item",{attrs:{label:t.alias}},["String"==t.webFieldType?a("el-input",{attrs:{disabled:""},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),e._v(" "),"Number"==t.webFieldType?a("el-input",{attrs:{disabled:""},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),e._v(" "),"Select"==t.webFieldType?a("el-input",{attrs:{disabled:""},model:{value:t.selectArr[t.value],callback:function(a){e.$set(t.selectArr,t.value,a)},expression:"item.selectArr[item.value]"}}):e._e(),e._v(" "),"ImageBASE64"==t.webFieldType||"ImageURL"==t.webFieldType?a("div",[""!=t.value?a("img",{staticClass:"avatar",attrs:{src:t.value},on:{click:function(a){return e.previewImage(t.value)}}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]):e._e()],1)})),1)],1)]),e._v(" "),a("el-dialog",{attrs:{title:"Add",visible:e.dialogAddVisible},on:{"update:visible":function(t){e.dialogAddVisible=t}}},[a("form",[a("el-form",{attrs:{"label-width":"80px"}},[e._l(e.insertFields,(function(t,i){return a("el-form-item",{attrs:{label:t.alias}},["String"==t.webFieldType?a("el-input",{attrs:{required:""},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),e._v(" "),"Number"==t.webFieldType?a("el-input",{attrs:{type:"number"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),e._v(" "),"Select"==t.webFieldType?a("el-select",{attrs:{placeholder:"please select"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}},e._l(t.selectArr,(function(e,t){return a("el-option",{attrs:{label:e,value:t}})})),1):e._e(),e._v(" "),"ImageBASE64"==t.webFieldType||"ImageURL"==t.webFieldType?a("input",{staticStyle:{filter:"alpha(opacity=0)",opacity:"0",width:"0",height:"0"},attrs:{name:"big_ticket",type:"file",value:"",accept:"image/jpg,image/jpeg,image/png,image/gif",id:i},on:{change:function(t){return e.getFilePath(i)}}}):e._e(),e._v(" "),"ImageBASE64"==t.webFieldType||"ImageURL"==t.webFieldType?a("div",{on:{click:function(t){return e.chooseImg(i)}}},[""!=t.value?a("img",{staticClass:"avatar",attrs:{src:t.value}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]):e._e()],1)})),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.addData}},[e._v("Confirm")]),e._v(" "),a("el-button",{on:{click:function(t){return e.cancelAdd()}}},[e._v("Cancel")])],1)],2)],1)]),e._v(" "),a("el-dialog",{attrs:{title:"Update",visible:e.dialogUpdateVisible},on:{"update:visible":function(t){e.dialogUpdateVisible=t}}},[a("form",[a("el-form",{attrs:{"label-width":"80px"}},[e._l(e.updateFields,(function(t,i){return a("el-form-item",{attrs:{label:t.alias}},["String"==t.webFieldType?a("el-input",{attrs:{required:""},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),e._v(" "),"Number"==t.webFieldType?a("el-input",{attrs:{type:"number"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),e._v(" "),"Select"==t.webFieldType?a("el-select",{attrs:{placeholder:"please select"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}},e._l(t.selectArr,(function(e,t){return a("el-option",{attrs:{label:e,value:t}})})),1):e._e(),e._v(" "),"ImageBASE64"==t.webFieldType||"ImageURL"==t.webFieldType?a("input",{staticStyle:{filter:"alpha(opacity=0)",opacity:"0",width:"0",height:"0"},attrs:{name:"big_ticket",type:"file",value:"",accept:"image/jpg,image/jpeg,image/png,image/gif",id:i},on:{change:function(t){return e.getFilePath(i)}}}):e._e(),e._v(" "),"ImageBASE64"==t.webFieldType||"ImageURL"==t.webFieldType?a("div",{on:{click:function(t){return e.chooseImg(i)}}},[""!=t.value?a("img",{staticClass:"avatar",attrs:{src:t.value}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]):e._e()],1)})),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.updateData}},[e._v("Confirm")]),e._v(" "),a("el-button",{on:{click:function(t){return e.cancelUpdate()}}},[e._v("Cancel")])],1)],2)],1)]),e._v(" "),a("el-dialog",{attrs:{title:"制作可视化视图",visible:e.makeChartVisible,width:"80%"},on:{"update:visible":function(t){e.makeChartVisible=t}}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form",{ref:"form",staticStyle:{width:"80%"},attrs:{model:e.buildChartForm,"label-width":"150px"}},[a("el-form-item",{staticClass:"block",attrs:{label:"可视化表名称"}},[a("el-input",{attrs:{placeholder:"可视化表名称"},model:{value:e.buildChartForm.title,callback:function(t){e.$set(e.buildChartForm,"title",t)},expression:"buildChartForm.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"可视化类型"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.buildChartForm.charttype,callback:function(t){e.$set(e.buildChartForm,"charttype",t)},expression:"buildChartForm.charttype"}},e._l(e.chartType,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),e.buildChartForm.charttype<"4"?a("el-form-item",{attrs:{label:"X  数据"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.buildChartForm.x,callback:function(t){e.$set(e.buildChartForm,"x",t)},expression:"buildChartForm.x"}},e._l(e.fields,(function(e,t){return a("el-option",{attrs:{label:e.alias,value:t}})})),1)],1):e._e(),e._v(" "),e.buildChartForm.charttype<"4"?a("el-form-item",{attrs:{label:"Y 数据"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.buildChartForm.y,callback:function(t){e.$set(e.buildChartForm,"y",t)},expression:"buildChartForm.y"}},e._l(e.fields,(function(e,t){return a("el-option",{attrs:{label:e.alias,value:t}})})),1)],1):e._e(),e._v(" "),e.buildChartForm.charttype>="4"?a("el-form-item",{attrs:{label:"Name"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.buildChartForm.x,callback:function(t){e.$set(e.buildChartForm,"x",t)},expression:"buildChartForm.x"}},e._l(e.fields,(function(e,t){return a("el-option",{attrs:{label:e.alias,value:t}})})),1)],1):e._e(),e._v(" "),e.buildChartForm.charttype>="4"?a("el-form-item",{attrs:{label:"value"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.buildChartForm.y,callback:function(t){e.$set(e.buildChartForm,"y",t)},expression:"buildChartForm.y"}},e._l(e.fields,(function(e,t){return a("el-option",{attrs:{label:e.alias,value:t}})})),1)],1):e._e(),e._v(" "),a("el-form-item",{staticClass:"block",attrs:{label:"数据范围 ["+e.buildChartForm.datarange+"] "}},[a("el-slider",{attrs:{range:"","show-stops":"",max:e.tableData.length,"color:red":""},model:{value:e.buildChartForm.datarange,callback:function(t){e.$set(e.buildChartForm,"datarange",t)},expression:"buildChartForm.datarange"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},["1"==e.buildChartForm.charttype?a("LineChart1",{attrs:{"chart-data":e.chartsData}}):e._e(),e._v(" "),"2"==e.buildChartForm.charttype?a("LineChart2",{attrs:{"chart-data":e.chartsData}}):e._e(),e._v(" "),"3"==e.buildChartForm.charttype?a("BarChart",{attrs:{"chart-data":e.chartsData}}):e._e(),e._v(" "),"4"==e.buildChartForm.charttype?a("PieChart1",{attrs:{"chart-data":e.chartsData}}):e._e(),e._v(" "),"5"==e.buildChartForm.charttype?a("PieChart2",{attrs:{"chart-data":e.chartsData}}):e._e(),e._v(" "),"6"==e.buildChartForm.charttype?a("PieChart3",{attrs:{"chart-data":e.chartsData}}):e._e()],1)],1),e._v(" "),a("div",{staticStyle:{position:"absolute",bottom:"10px",right:"20px"}},[a("i",{staticClass:"el-icon-full-screen",on:{click:e.showMaxCharts}})])],1),e._v(" "),a("el-dialog",{attrs:{title:"可视化大图",visible:e.dialogMaxChartVisible},on:{"update:visible":function(t){e.dialogMaxChartVisible=t}}},[a("el-row",{attrs:{gutter:20}},["1"==e.maxChartsType?a("LineChart1",{staticStyle:{width:"100%"},attrs:{"chart-data":e.chartsMaxData}}):e._e(),e._v(" "),"2"==e.maxChartsType?a("LineChart2",{staticStyle:{width:"100%"},attrs:{"chart-data":e.chartsMaxData}}):e._e(),e._v(" "),"3"==e.maxChartsType?a("BarChart",{staticStyle:{width:"100%"},attrs:{"chart-data":e.chartsMaxData}}):e._e(),e._v(" "),"4"==e.maxChartsType?a("PieChart1",{staticStyle:{width:"100%"},attrs:{"chart-data":e.chartsMaxData}}):e._e(),e._v(" "),"5"==e.maxChartsType?a("PieChart2",{staticStyle:{width:"100%"},attrs:{"chart-data":e.chartsMaxData}}):e._e(),e._v(" "),"6"==e.maxChartsType?a("PieChart3",{staticStyle:{width:"100%"},attrs:{"chart-data":e.chartsMaxData}}):e._e()],1)],1)],2)},l=[],s=(a("2b45"),a("c904"),a("cc57"),a("ad8f")),r=a("0ccd"),n=a("4c59"),o=a("cb5e"),c=a("76db"),d=a("afab"),u=a("27d2"),h={components:{LineChart1:r["a"],LineChart2:n["a"],PieChart1:o["a"],PieChart2:c["a"],PieChart3:d["a"],BarChart:u["a"]},data:function(){return{loading:!1,readyCharts:{},pageSizes:[],maxChartsType:"",chartsMaxData:{},localSort:!1,dialogMaxChartVisible:!1,chartsData:{xdata:[],ydata:[],name:""},buildChartForm:{},chartType:[{label:"曲线图",value:"1"},{label:"折线图",value:"2"},{label:"柱形图",value:"3"},{label:"饼状图1",value:"4"},{label:"饼状图2",value:"5"},{label:"饼状图3",value:"6"}],makeChartVisible:!1,searchNum:0,searchField:[],searchType:[],searchTypes:[{name:"模糊查询",value:"like"},{name:"精确查询",value:"equals"},{name:"大于",value:"greater"},{name:"小于",value:"less"},{name:"大于等于",value:"greaterAndequals"},{name:"小于等于",value:"lessAndequals"}],queryText:[],permission:[],addform:{},dialogLookVisible:!1,dialogAddVisible:!1,dialogUpdateVisible:!1,totalNum:100,pageSize:6,currentPage:1,downloadLoading:!1,table:this.$route.name,tableData:[],choiceFields:[],fields:{},fieldsNameArr:[],fieldsAliasNameArr:[],defultFields:{},updateFields:{},insertFields:{},findFields:{},lookFields:{},sortFields:{},dialogPreviewVisible:!1,previewImageUrl:"",tempUpdateRow:{},findData:[],sort:null}},mounted:function(){this.initData()},methods:{selectChart:function(e){var t=this,a=this;e={u:"gchart",table:a.table,chart:e};Object(s["c"])(e).then((function(e){if(console.log(e),1e3==e.code){var i=e.data.data,l=i.title,s=i.chart;a.maxChartsType=s.type,a.chartsMaxData={xdata:s.xvalues,ydata:s.yvalues,title:""==s.title?l:s.title,xname:s.xname,yname:s.yname},a.dialogMaxChartVisible=!0}else t.$message.error(e.msg)})).catch((function(e){console.log(e),alert("请求出错")}))},showMaxCharts:function(){this.dialogMaxChartVisible=!0,this.chartsMaxData=this.chartsData,this.maxChartsType=this.buildChartForm.charttype},sortChange:function(e){var t=e.prop,a=e.order,i=(this.sortFields,this.tableData),l=this;if(-1==this.choiceFields.indexOf("remoteSort")){var s=function(e,i){return"ascending"==a?isNaN(e[t])?e[t].length-i[t].length:e[t]-i[t]:isNaN(e[t])?i[t].length-e[t].length:i[t]-e[t]};i.sort(s),this.tableData=i}else{var r={};r["field"]=t,r["desc"]="ascending"!=a,l.sort=r,l.initData(),l.sort=null}},deleteSearchNum:function(e){this.searchField.splice(e,1),this.searchType.splice(e,1),this.queryText.splice(e,1),this.searchNum--},addSearchNum:function(){this.searchNum++},handleSearch:function(){this.findData=[],this.likeData={};var e=this.searchType,t=this.searchField,a=this.queryText;if(0!=e.length&&e.length==t.length&&e.length==a.length){e.length>1&&this.$message("重复搜索条件会覆盖(上面会覆盖下面)");for(var i=[],l=0;l<e.length;l++)i.push({key:this.searchField[l],value:this.queryText[l],compare:this.searchType[l]});this.findData=i}else this.$message.error("搜索条件不完整");this.initData()},updateData:function(){var e=this,t=this,a=this.updateFields,i={};for(var l in a){if(""==a[l]["value"])return void this.$message.error("添加表单有未填写项");i[l]=a[l]["value"]}var r=this.tempUpdateRow,n={};for(var l in console.log(r),r)0==l.indexOf("pk_")&&(n[l.slice(3)]=r[l]);var o={u:"utable",table:t.table,fields:i,pk:n};Object(s["f"])(o).then((function(a){console.log(a),1017==a.code?(e.$message({message:"更新成功",type:"success"}),t.initData(),t.dialogUpdateVisible=!1):e.$message.error(a.msg)})).catch((function(e){console.log(e),alert("请求出错")}))},cancelUpdate:function(){this.dialogUpdateVisible=!1},handleUpdate:function(e){this.dialogUpdateVisible=!0,this.tempUpdateRow=e;var t=this.updateFields;for(var a in t)t[a]["value"]=e[a];this.updateFields=t},handleLook:function(e){var t=this.defultFields;for(var a in t)t[a]["value"]=e[a];this.lookFields=t,this.dialogLookVisible=!0},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除该条信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=t;console.log(e);var i={};for(var l in e)0==l.indexOf("pk_")&&(i[l.slice(3)]=e[l]);var r={u:"dtable",table:a.table,fields:i};Object(s["b"])(r).then((function(e){console.log(e),1021==e.code?(t.$message({message:"删除成功",type:"success"}),a.initData()):t.$message.error(e.msg)})).catch((function(e){console.log(e),alert("请求出错")}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},chooseImg:function(e){var t=document.getElementById(e);t.click()},getFilePath:function(e){var t=this,a=document.getElementById(e);if(1==a.files.length){var i=new FileReader;i.readAsDataURL(a.files[0]),i.onloadend=function(){t.insertFields[e]["value"]=i.result}}},addData:function(){var e=this,t=this,a=this.insertFields,i={};for(var l in a){if(""==a[l]["value"])return void this.$message.error("添加表单有未填写项");i[l]=a[l]["value"]}console.log(i);var r={u:"atable",table:t.table,fields:i};Object(s["a"])(r).then((function(a){console.log(a),1019==a.code?(e.$message({message:"插入成功",type:"success"}),t.initData(),t.dialogAddVisible=!1):e.$message.error(a.msg)})).catch((function(e){console.log(e),alert("请求出错")}))},handleAdd:function(){var e=this.insertFields;for(var t in e)e[t]["value"]=null;this.insertFields=e,this.dialogAddVisible=!0},cancelAdd:function(){this.dialogAddVisible=!1},handleSizeChange:function(e){this.pageSize=e,this.initData()},refreshData:function(){this.findData=[],this.initData()},handleCurrentChange:function(e){this.currentPage=e,this.initData()},handleClick:function(e){console.log(e)},previewImage:function(e){this.previewImageUrl=e,this.dialogPreviewVisible=!0},handleDownload:function(){var e=this;this.downloadLoading=!0;var t=this;Promise.all([a.e("chunk-6314a9fb"),a.e("chunk-2133cd4f")]).then(a.bind(null,"4bf8")).then((function(a){var i=t.fieldsAliasNameArr,l=t.fieldsNameArr,s=t.formatJson(l);a.export_json_to_excel({header:i,data:s,filename:"table-"+t.table}),e.downloadLoading=!1}))},formatJson:function(e){return console.log(this.tableData),console.log(e),this.tableData.map((function(t){return e.map((function(e){return void 0!=t[e]&&t[e].toString().length>200?"数据太长不显示":t[e]}))}))},initData:function(){var e=this,t=this;t.loading=!0;var a={u:"gtable",table:t.table,pagenum:t.currentPage,pagesize:t.pageSize,find:t.findData,sort:t.sort};Object(s["d"])(a).then((function(a){var i=a.data.data;if(console.log(i),null!=i){t.tableData=i.data,t.permission=i.permission,t.totalNum=i.total;for(var l=[],s=0;s<=i.total/50+1;s++)l.push(50*s);l[0]=6,e.pageSizes=l;var r={},n={},o={},c=[];for(var d in i.fields){if(null!=i.fields[d]["selects"]){var u=i.fields[d]["selects"],h={};for(s=0;s<u.length;s+=2)s+1<u.length&&(h[u[s+1]]=u[s]);i.fields[d]["selectArr"]=h}i.fields[d]["fieldPermission"].indexOf("update")>=0&&(r[d]=i.fields[d]),i.fields[d]["fieldPermission"].indexOf("insert")>=0&&(i.fields[d]["value"]="",n[d]=i.fields[d]),i.fields[d]["fieldPermission"].indexOf("find")>=0&&(o[d]=i.fields[d]),i.fields[d]["fieldPermission"].indexOf("sort")>=0&&c.push(d)}t.insertFields=n,t.updateFields=r,t.findFields=o,t.sortFields=c,t.fields=i.fields,t.defultFields=i.fields,t.readyCharts=i.wchart,t.loading=!1,e.$message({message:"数据加载成功",type:"success"})}else e.$message({message:"抱歉，您没有查看权限",type:"warning"})})).catch((function(a){e.$message.error("加载数据出错"),t.loading=!1}))}},watch:{choiceFields:function(e){var t={},a=[],i=[];for(var l in this.defultFields)e.indexOf(l)>=0&&(t[l]=this.defultFields[l],a.push(l),i.push(this.defultFields[l]["alias"]));this.fields=t,this.fieldsNameArr=a,this.fieldsAliasNameArr=i},buildChartForm:{deep:!0,handler:function(e){for(var t=e.x,a=e.y,i=e.datarange,l=[],s=[],r=this.tableData,n=i[0];n<i[1];n++){if(void 0==r[n][t])return;if(void 0==r[n][a])return;l.push(r[n][t]),s.push(r[n][a])}this.chartsData.xdata=l,this.chartsData.ydata=s,this.chartsData.name=this.fields[a]["alias"],this.chartsData.xname=this.fields[t]["alias"],this.chartsData.yname=this.fields[a]["alias"],this.chartsData.title=e.title}}}},p=h,m=(a("d8eb"),a("5511")),f=Object(m["a"])(p,i,l,!1,null,"7b02e9ce",null);t["default"]=f.exports},a2cd:function(e,t,a){"use strict";var i=a("238a");e.exports=function(e,t){return!!e&&i((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},c904:function(e,t,a){"use strict";var i=a("e46b"),l=a("5daa"),s=a("008a"),r=a("238a"),n=[].sort,o=[1,2,3];i(i.P+i.F*(r((function(){o.sort(void 0)}))||!r((function(){o.sort(null)}))||!a("a2cd")(n)),"Array",{sort:function(e){return void 0===e?n.call(s(this)):n.call(s(this),l(e))}})},d8eb:function(e,t,a){"use strict";var i=a("4c0f"),l=a.n(i);l.a}}]);